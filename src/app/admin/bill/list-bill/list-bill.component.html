<div class="container order-page">

  <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap gap-3">
    <h2 class="page-title mb-0">Danh sách đơn hàng</h2>
    <form [formGroup]="search" (ngSubmit)="searchP()">
      <div class="search-input-wrapper">
        <input id="sc" type="text" class="form-control search-input" formControlName="name" placeholder="Tìm theo mã khách hàng">
        <button type="submit" class="search-icon-btn"><i class="fa fa-search"></i></button>
      </div>
    </form>
  </div>

  <div class="card">
    <div class="table-responsive-custom">
      <table class="table table-bordered table-hover align-middle">
        <thead class="table-dark">
          <tr>
            <th>Đơn</th>
            <th>Mã KH</th>
            <th>Họ tên</th>
            <th>SDT</th>
            <th>Tổng tiền</th>
            <th>Ngày mua</th>
            <th>Thanh toán</th>
            <th>Trạng thái</th>
            <th width="140">Hành động</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let p of billList">
            <td>{{ p.idBill }}</td>
            <td>{{ p?.customer?.idCustomer }}</td>
            <td class="fw-semibold">{{ p?.customer?.surname }} {{ p?.customer?.name }}</td>
            <td>{{ p?.customer?.phone }}</td>
            <td class="text-danger fw-semibold">{{ numToString(p.totalMoney) }}<sup>đ</sup></td>
            <td>{{ p.dateFounded | date:'HH:mm:ss dd/MM/yyyy' }}</td>
            <td>{{ p.paymentMethods }}</td>
            <td>
              <span *ngIf="p.status===0" class="status-pill status-cancel">Đơn đã huỷ</span>
              <span *ngIf="p.status===1" class="status-pill status-wait">Chờ duyệt</span>
              <span *ngIf="p.status===2" class="status-pill status-success">Thành công</span>
            </td>
            <td class="text-nowrap">
              <button class="btn btn-sm btn-outline-warning me-1" (click)="xem(p.idBill)"><i class="fa fa-eye"></i></button>
              <button *ngIf="p.status===1" class="btn btn-sm btn-outline-success me-1" (click)="duyet(p.idBill)"><i class="fa fa-check"></i></button>
              <button class="btn btn-sm btn-outline-danger" (click)="delete(p.idBill)"><i class="fa fa-trash"></i></button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <nav *ngIf="totalPagination>1" class="mt-4">
    <ul class="pagination justify-content-center">
      <li class="page-item" *ngFor="let _ of [].constructor(totalPagination); let i=index" [hidden]="i<indexPagination-4||i>indexPagination+2" [class.active]="indexPagination===i+1">
        <a class="page-link" (click)="getPage(i)">{{ i+1 }}</a>
      </li>
    </ul>
  </nav>

</div>
