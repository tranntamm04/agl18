<div class="container rating-page">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="page-title mb-0">Quản lý đánh giá</h2>
    <span class="text-muted fst-italic">
      Tổng: {{ ratings.length }} đánh giá
    </span>
  </div>

  <div *ngIf="loading" class="alert alert-info">
    Đang tải dữ liệu...
  </div>

  <div class="card" *ngIf="!loading">
    <div class="table-responsive-custom">
      <table class="table table-bordered table-hover align-middle">
        <thead class="table-dark">
          <tr>
            <th>Khách hàng</th>
            <th>Sản phẩm</th>
            <th>Sao</th>
            <th>Bình luận</th>
            <th>Ngày</th>
            <th>Status</th>
            <th width="160">Hành động</th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let r of ratings">
            <td class="fw-semibold">{{ r.customer.idCustomer }}</td>
            <td>{{ r.product.productName }}</td>

            <td class="star-cell">
              <i
                *ngFor="let s of [1,2,3,4,5]"
                class="fa fa-star"
                [class.text-warning]="s <= r.numberOfStar">
              </i>
            </td>

            <td class="comment-cell" title="{{ r.comment }}">
              {{ r.comment }}
            </td>

            <td class="text-muted">
              {{ r.dateFounded | date:'dd/MM/yyyy' }}
            </td>

            <td>
              <span
                class="badge"
                [class.bg-success]="r.status === 1"
                [class.bg-secondary]="r.status === 0">
                {{ r.status === 1 ? 'Hiển thị' : 'Ẩn' }}
              </span>
            </td>

            <td class="action-cell">
              <button
                class="btn btn-sm btn-outline-warning me-1"
                (click)="toggleStatus(r)">
                {{ r.status === 1 ? 'Ẩn' : 'Hiện' }}
              </button>

              <button
                class="btn btn-sm btn-outline-danger"
                (click)="deleteRating(r)">
                Xóa
              </button>
            </td>
          </tr>

          <tr *ngIf="ratings.length === 0">
            <td colspan="7" class="text-center text-muted py-4">
              Không có đánh giá nào
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
